{% extends "base.html" %}
{% block title %}הוספת מוצר{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="card shadow p-4">
    <h2 class="mb-4 text-center">הוספת מוצר חדש</h2>

    <form action="/add-product" method="post" enctype="multipart/form-data" onsubmit="return validateSizes()">

      <div class="mb-3">
        <label class="form-label">שם המוצר</label>
        <input type="text" name="name" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">תיאור</label>
        <textarea name="description" class="form-control" rows="3" required></textarea>
      </div>

      <div class="mb-3">
        <label class="form-label">מחיר (₪)</label>
        <input type="number" name="price" class="form-control" min="0" step="0.01" required>
      </div>

      <div class="mb-3">
        <label class="form-label">תמונה</label>
        <input type="file" name="image_file" class="form-control" accept="image/*" required>
      </div>

      <!-- מידות לבגדים -->
      <div class="mb-3">
        <label class="form-label">מידת בגדים (לדוגמה: S, M, L או ריק אם לא רלוונטי)</label>
        <input type="text" name="size_clothes" class="form-control" placeholder="מידת בגדים">
      </div>

      <!-- מידות לנעליים (טווח) -->
      <div class="mb-3">
        <label class="form-label">טווח מידות נעליים (ריק אם לא רלוונטי)</label>
        <div class="d-flex gap-2">
          <select name="size_shoes_min" class="form-select">
            <option value="" selected>מינימום</option>
            {% for size in range(25, 49) %}
              <option value="{{ size }}">{{ size }}</option>
            {% endfor %}
          </select>
          <select name="size_shoes_max" class="form-select">
            <option value="" selected>מקסימום</option>
            {% for size in range(25, 49) %}
              <option value="{{ size }}">{{ size }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" id="is_hot" name="is_hot">
        <label class="form-check-label" for="is_hot">מוצר חם 🔥</label>
      </div>

      <button type="submit" class="btn btn-success w-100">הוסף מוצר</button>
    </form>
  </div>
</div>

<script>
  function validateSizes() {
    const clothesSize = document.querySelector('input[name="size_clothes"]').value.trim();
    const shoeMin = document.querySelector('select[name="size_shoes_min"]').value;
    const shoeMax = document.querySelector('select[name="size_shoes_max"]').value;

    if (!clothesSize && (!shoeMin || !shoeMax)) {
      alert("יש להזין לפחות מידת בגדים או טווח מידות נעליים.");
      return false;
    }
    if (shoeMin && shoeMax && parseInt(shoeMin) > parseInt(shoeMax)) {
      alert("מידת המינימום לנעליים לא יכולה להיות גדולה מהמקסימום.");
      return false;
    }
    return true;
  }
</script>
{% endblock %}
